<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Визуализация магнитного поля</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    font-family: sans-serif;
    background: #111;
    color: #fff;
  }
  canvas {
    display: block;
  }
  #ui {
    position: absolute;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(255,255,255,0.9);
    padding: 10px 20px;
    border-radius: 10px;
    color: #000;
    font-weight: bold;
  }
  input { margin-left: 10px; }

  #currentValue {
  display: inline-block;
  width: 40px;           
  text-align: right;
}

</style>

</head>
<body>

<div id="ui">
  <span></span>
  <input id="current" type="range" min="-5" max="5" step="0.1" value="2">
  <span id="currentValue">2</span>
</div>

<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let width = window.innerWidth;
let height = window.innerHeight;
canvas.width = width;
canvas.height = height;

const centerX = width / 2;
const centerY = height / 2;

const currentInput = document.getElementById('current');
const currentValue = document.getElementById('currentValue');

let current = parseFloat(currentInput.value);

const particles = [];
const numParticles = 500;
const maxRadius = Math.min(width, height) * 0.45;

for (let i = 0; i < numParticles; i++) {
    const angle = Math.random() * Math.PI * 2;
    const radius = 20 + Math.random() * maxRadius;
    const baseSpeed = 0.01 + Math.random()*0.02;
    particles.push({angle, radius, baseSpeed});
}

function drawConductor() {
    ctx.fillStyle = '#cc33ff';
    ctx.beginPath();
    ctx.arc(centerX, centerY, 20, 0, Math.PI * 2);
    ctx.fill();
}

function drawParticles() {
    particles.forEach(p => {
        const direction = current >= 0 ? 1 : -1;
        const speed = p.baseSpeed * Math.abs(current);
        p.angle += direction * speed;

        const x = centerX + p.radius * Math.cos(p.angle);
        const y = centerY + p.radius * Math.sin(p.angle);

        ctx.beginPath();
        ctx.arc(x, y, 2, 0, Math.PI * 2);
        ctx.fillStyle = 'rgba(0,255,255,0.7)';
        ctx.fill();
    });
}

function drawFieldLines() {
    const spacing = 50;
    ctx.strokeStyle = 'rgba(0,150,255,0.2)';
    ctx.lineWidth = 1;
    for (let r = spacing; r < maxRadius; r += spacing) {
        ctx.beginPath();
        ctx.arc(centerX, centerY, r, 0, Math.PI * 2);
        ctx.stroke();
    }
}

function animate() {
    ctx.fillStyle = 'rgba(17,17,17,0.3)';
    ctx.fillRect(0,0,width,height);

    drawFieldLines();
    drawConductor();
    drawParticles();

    requestAnimationFrame(animate);
}

currentInput.addEventListener('input', () => {
    current = parseFloat(currentInput.value);
    currentValue.textContent = current;
});

window.addEventListener('resize', () => {
    width = window.innerWidth;
    height = window.innerHeight;
    canvas.width = width;
    canvas.height = height;
});

animate();
</script>
</body>
</html>
